    [observer]	CREATE TABLE events (
    [observer]	  id text NOT NULL,
    [observer]	  available_seats integer NOT NULL CHECK (available_seats >= 0),
    [observer]	  PRIMARY KEY (id)
    [observer]	);	(3.1ms)
    [observer]	CREATE TABLE bookings (
    [observer]	  id integer PRIMARY KEY,
    [observer]	  customer_name text NOT NULL,
    [observer]	  seat_count integer NOT NULL,
    [observer]	  event_id text NOT NULL,
    [observer]	  FOREIGN KEY (event_id) REFERENCES events (id)
    [observer]	);	(3.0ms)
    [observer]	BEGIN ISOLATION LEVEL READ COMMITTED	(0.5ms)
    [observer]	INSERT INTO "events" ("id", "available_seats") VALUES ('event_a', 2) RETURNING "id"	(0.9ms)
    [observer]	INSERT INTO "bookings" ("id", "customer_name", "seat_count", "event_id") VALUES (1, 'Alice', 1, 'event_a') RETURNING "id"	(0.9ms)
    [observer]	INSERT INTO "bookings" ("id", "customer_name", "seat_count", "event_id") VALUES (2, 'Bob', 1, 'event_a') RETURNING "id"	(0.6ms)
    [observer]	COMMIT	(0.8ms)
         [bob]		BEGIN ISOLATION LEVEL SERIALIZABLE	(0.6ms)
         [bob]		SELECT SUM("bookings"."seat_count") FROM "bookings" WHERE "bookings"."customer_name" IN ('Alice', 'Bob') AND "bookings"."event_id" = 'event_a'	(1.1ms)
         [bob]		=> 2
         [bob]		UPDATE "bookings" SET "seat_count" = 2 WHERE "bookings"."customer_name" = 'Bob' AND "bookings"."event_id" = 'event_a'	(0.7ms)
       [alice]			BEGIN ISOLATION LEVEL SERIALIZABLE	(5.3ms)
       [alice]			UPDATE "bookings" SET "seat_count" = 2 WHERE "bookings"."customer_name" = 'Alice' AND "bookings"."event_id" = 'event_a'	(12.0ms)
       [alice]			COMMIT	(2.4ms)
    [observer]	BEGIN ISOLATION LEVEL SERIALIZABLE READ ONLY DEFERRABLE;	(0.9ms)
    [observer]	SELECT "bookings"."customer_name", "bookings"."seat_count" FROM "bookings" WHERE "bookings"."customer_name" IN ('Alice', 'Bob')	(0.7ms)
    [observer]	=> [["Alice", 2], ["Bob", 1]]
    [observer]	COMMIT;	(0.6ms)
         [bob]		COMMIT	(2.2ms)
         [bob]		ROLLBACK	(3.2ms)
         [bob]		-> raised ActiveRecord::SerializationFailure PG::TRSerializationFailure: ERROR:  could not serialize access due to read/write dependencies among transactions
DETAIL:  Reason code: Canceled on identification as a pivot, during commit attempt.
HINT:  The transaction might succeed if retried.
         [bob]		BEGIN ISOLATION LEVEL SERIALIZABLE	(1.6ms)
         [bob]		SELECT SUM("bookings"."seat_count") FROM "bookings" WHERE "bookings"."customer_name" IN ('Alice', 'Bob') AND "bookings"."event_id" = 'event_a'	(3.4ms)
         [bob]		=> 3
         [bob]		UPDATE "bookings" SET "seat_count" = 0 WHERE "bookings"."customer_name" = 'Bob' AND "bookings"."event_id" = 'event_a'	(1.4ms)
         [bob]		COMMIT	(3.0ms)
    [observer]	SELECT "bookings"."customer_name", "bookings"."seat_count" FROM "bookings" WHERE "bookings"."customer_name" IN ('Alice', 'Bob')	(3.7ms)
    [observer]	=> [["Alice", 2], ["Bob", 0]]
    [observer]	DROP TABLE IF EXISTS bookings;	(8.8ms)
    [observer]	DROP TABLE IF EXISTS events;	(6.9ms)
